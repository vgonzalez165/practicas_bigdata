```
------------- ESPECIALIZACIÓN EN INTELIGENCIA ARTIFICIAL Y BIG DATA -------------
---------------------------------------------------------------------------------

Módulo:                     SISTEMAS DE BIG DATA
Profesor:                   Víctor J. González
Unidad de Trabajo:          UT03. Gestión de los datos
Práctica:                   PR0303: Obtención de datos de una API REST
Resultados de aprendizaje:  
```


# PR0303: Obtención de datos de una API REST


# Práctica: Ingesta de Datos con Star Wars API (SWAPI)

El objetivo de esta práctica será desarrollar un script en Python que extraiga información de [swapi.dev](https://swapi.dev/) y la transforme en DataFrames de Pandas listos para el análisis.

## 1.- Conexión básica y primer dataFrame

En esta fase, debes conectar con el endpoint de **Vehículos** y extraer la primera página de resultados (10 elementos).

Los pasos a realizar son:

1. Realizaruna petición `GET` al endpoint `https://swapi.dev/api/vehicles/`.
2. Extrae la clave `results` del JSON de respuesta.
3. Convierte esa lista de diccionarios en un dataframe de Pandas.
4. Muestra las primeras 5 filas y el nombre de las columnas obtenidas.


## 2.- Gestión de paginación

La API de Star Wars devuelve los resultados de 10 en 10. Pero necesitamos el dataset completo de **personajes (people)**.

En este apartado debes:

1. Implementar un bucle (`while`) que verifique la existencia de la clave `next` en el JSON.
2. Iterar por todas las páginas (aprox. 82 personajes) recolectando los datos en una lista global.
3. Crear un DataFrame único con todos los registros.
4. Verifica que el DataFrame resultante tenga el mismo número de filas que el valor indicado en la clave `count` de la API.


## 3.- Cruce de datos

En este punto vamos a combinar datos de diferentes endpoints, en concreto, enriqueceremos los datos de personajes obtenidos en el punto anterior con información de su planeta de origen.

Tienes que hacer lo siguiente:

1. La columna `homeworld` de cada personaje es una URL (ej: `https://swapi.dev/api/planets/1/`).
2. Crea una función que reciba esa URL y devuelva una tupla con el **nombre, terreno y población del planeta** (haciendo una nueva petición a la API).
3. Aplica esta función a los primeros 20 personajes del DataFrame (para no saturar la API) y añade al dataframe de personajes los datos correspondientes a su planeta.


## 4.- Expansión de filas (opcional)

Seguro que te has fijado que la consulta de personajes devuelve un JSON en el que hay un campo que contiene una lista de películas en que aparece dicho personaje. Ese campo combinado es poco útil si queremos realizar operaciones para extraer información de los datos (por ejemplo, cuántos personajes de media hay en cada película?).

Vas a usar la función `explode()` de Pandas, que expande un registro con un campo con una lista en varios registros, uno por cada elemento que tenga la lista.

Por ejemplo, si tenemos los siguientes datos en un dataframe:
```
Luke Skywalker	172	['film1', 'film2', 'film3']
```

Y ejecutamos `df.explode('films')` obtendremos lo siguiente:

```
Luke Skywalker	172	film1
Luke Skywalker	172	film2
Luke Skywalker	172	film3
```

Realiza esta operación sobre el dataframe del ejercicio anterior para expandir la lista de películas de cada personaje (hazlo sobre un subconjunto de los datos para no sobrecargar la API) y reemplaza el identificador de la película por su título.