```
------------- ESPECIALIZACIÓN EN INTELIGENCIA ARTIFICIAL Y BIG DATA -------------
---------------------------------------------------------------------------------

Módulo:                     SISTEMAS DE BIG DATA
Profesor:                   Víctor J. González
Unidad de Trabajo:          UT03. Gestión de los datos
Práctica:                   PR0302: Lectura avanzada de datos de archivos
Resultados de aprendizaje:  
```


# PR0302: Lectura avanzada de datos de archivos

## Objetivo de la Práctica

Esta práctica es una revisión de la anterior donde aumentamos el nivel de dificultad ya que los archivos de origen tienen sus *peculiaridades*.

Nuevamente tienes que leer datos de tres fuentes diferentes (CSV, Excel y JSON) y volcar el resultado a un archivo CSV.

Las fuentes son:

1. **Norte ([`ventas_norte_v2.csv`](./data/ventas_norte_v2.csv)):** 

- Formato CSV delimitado por punto y coma (`;`).
- El campo `Direccion_Envio` contiene comas reales (ej: "Calle Mayor, 12"). Debes asegurarte de que Pandas no rompa las filas al leerlo.
- El campo `Total_Factura` viene como texto con símbolos de moneda (ej: "$1,200.50"). Deberás limpiarlo y convertirlo a `float`.


2. **Sur ([`ventas_sur.xlsx`](./data/ventas_sur_v2.xlsx)):**

- Archivo Excel con **múltiples hojas** (`Q1_2023`, `Q2_2023`).
- Contiene columnas booleanas (`Es_Cliente_Corporativo`) y de estado (`Estado_Envio`) que deben conservarse.
- Debes calcular una columna `Total` que no existe explícitamente (`Precio_Base` * `Cantidad` * (1 - `Descuento_Aplicado`)).


3. **Este ([`ventas_este.json`](./data/ventas_este_v2.json)):**

- JSON de con varios niveles de anidamiento
- La información útil está sepultada bajo `data -> payload -> transaccion`.
- Debes extraer:
   - ID del registro.
   - Fecha.
   - Ciudad del comprador.
   - Nombre del producto.
   - Cantidad.
   - Precio de lista y el monto del IVA (que está en un sub-diccionario).
- Debes descartar metadatos técnicos (`latency_ms`, `source_system`).


El DataFrame final debe tener **exactamente** estas columnas estandarizadas:

- `id_transaccion`
- `fecha`
- `region`
- `producto`
- `cantidad`
- `total_venta`
- `ciudad`
